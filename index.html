<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PESO Training Center Registration Form</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Inter Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            /* Background image from the user's uploaded file */
            background-image: url('https://github.com/ictcentergeneraltrias/pesotrainingcenter/blob/main/Screen%20Shot%202024-03-11%20at%209.47.20%20AM.png?raw=true');
            background-size: cover; /* Cover the entire background */
            background-position: center; /* Center the background image */
            background-repeat: no-repeat; /* Do not repeat the image */
            background-attachment: fixed; /* Keep background fixed when scrolling */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }
        .form-container {
            background-color: rgba(238, 242, 255, 0.95); /* Lighter Royal Blue (indigo-100) with slight transparency */
            padding: 2.5rem; /* 40px */
            border-radius: 1.5rem; /* 24px */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            max-width: 500px;
            width: 100%;
            backdrop-filter: blur(5px); /* Optional: Add a subtle blur to the background behind the form */
            -webkit-backdrop-filter: blur(5px); /* For Safari */
        }
        .form-input {
            width: 100%;
            padding: 0.75rem 1rem; /* 12px 16px */
            border: 1px solid #a5b4fc; /* Royal Blue (indigo-300) border */
            border-radius: 0.5rem; /* 8px */
            font-size: 1rem;
            line-height: 1.5;
            transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
        }
        .form-input:focus {
            outline: none;
            border-color: #6366f1; /* Royal Blue (indigo-500) focus border */
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.25); /* Royal Blue shadow on focus */
        }
        .form-button {
            width: 100%;
            padding: 0.75rem 1.5rem; /* 12px 24px */
            background-color: #4338ca; /* Royal Blue (indigo-700) */
            color: #ffffff;
            font-weight: 600;
            border-radius: 0.75rem; /* 12px */
            cursor: pointer;
            transition: background-color 0.2s ease-in-out;
        }
        .form-button:hover {
            background-color: #3730a3; /* Darker Royal Blue (indigo-800) on hover */
        }

        /* Modal specific styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6); /* Slightly darker overlay for better contrast with light form */
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
        }
        .modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }
        .modal-content {
            background-color: #ffffff;
            padding: 2rem;
            border-radius: 0.75rem;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            max-width: 400px;
            width: 90%;
            text-align: center;
            transform: translateY(-20px);
            transition: transform 0.3s ease-in-out;
        }
        .modal-overlay.show .modal-content {
            transform: translateY(0);
        }
        .modal-content.success {
            background-color: #d1fae5; /* Light green */
            border: 1px solid #34d399; /* Green border */
            color: #065f46; /* Dark green text */
        }
        .modal-content.error {
            background-color: #fee2e2; /* Light red */
            border: 1px solid #ef4444; /* Red border */
            color: #991b1b; /* Dark red text */
        }
        .modal-content.info {
            background-color: #eef2ff; /* Very light indigo to match scheme */
            border: 1px solid #a5b4fc; /* Indigo-300 border */
            color: #4338ca; /* Indigo-700 text */
        }
        .modal-close-button {
            background-color: #4338ca; /* Royal Blue (indigo-700) */
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            cursor: pointer;
            margin-top: 1.5rem;
            transition: background-color 0.2s ease-in-out;
        }
        .modal-close-button:hover {
            background-color: #3730a3; /* Darker Royal Blue (indigo-800) */
        }
        .modal-agree-button {
            background-color: #15803d; /* Royal Green (green-700) for agree */
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            cursor: pointer;
            margin-top: 1.5rem;
            transition: background-color 0.2s ease-in-out;
        }
        .modal-agree-button:hover {
            background-color: #166534; /* Darker Royal Green (green-800) for agree */
        }
    </style>
</head>
<body>
    <div class="form-container">
        <h2 class="text-3xl font-bold text-center text-gray-800 mb-8">PESO TRAINING CENTER REGISTRATION FORM</h2>

        <form id="registrationForm" class="space-y-6">
            <div>
                <label for="fullName" class="block text-gray-700 text-sm font-medium mb-2">Full Name</label>
                <!-- Comment: Full Name needs to be in ALL CAPS letters -->
                <input type="text" id="fullName" name="fullName" class="form-input" placeholder="JUAN DELA CRUZ" required>
            </div>

            <div>
                <label for="gender" class="block text-gray-700 text-sm font-medium mb-2">Gender</label>
                <select id="gender" name="gender" class="form-input" required>
                    <option value="">-- Select Gender --</option>
                    <option value="Man">Man</option>
                    <option value="Woman">Woman</option>
                    <option value="Member of LGBTQIA+ Community">Member of LGBTQIA+ Community</option>
                </select>
            </div>

            <div>
                <label for="ageGroup" class="block text-gray-700 text-sm font-medium mb-2">Age Group</label>
                <select id="ageGroup" name="ageGroup" class="form-input" required>
                    <option value="">-- Select Age Group --</option>
                    <option value="19 and below">19 and below</option>
                    <option value="20-29">20-29</option>
                    <option value="30-39">30-39</option>
                    <option value="40-49">40-49</option>
                    <option value="50-59">50-59</option>
                    <option value="60 and above">60 and above</option>
                </select>
            </div>

            <div>
                <label for="email" class="block text-gray-700 text-sm font-medium mb-2">Email Address</label>
                <input type="email" id="email" name="email" class="form-input" placeholder="peso@generaltrias.gov.ph" required>
            </div>

            <div>
                <label for="phone" class="block text-gray-700 text-sm font-medium mb-2">Phone Number</label>
                <!-- Comment: Phone number should be an 11-digit number -->
                <input type="tel" id="phone" name="phone" class="form-input" placeholder="09170001234">
            </div>

            <div>
                <label for="residentialBarangay" class="block text-gray-700 text-sm font-medium mb-2">Residential Barangay</label>
                <select id="residentialBarangay" name="residentialBarangay" class="form-input" required>
                    <option value="">-- Select Barangay --</option>
                    <option value="Alingaro">Alingaro</option>
                    <option value="Arnaldo">Arnaldo</option>
                    <option value="Bacao I">Bacao I</option>
                    <option value="Bacao II">Bacao II</option>
                    <option value="Bagumbayan">Bagumbayan</option>
                    <option value="Biclatan">Biclatan</option>
                    <option value="Buenavista I">Buenavista I</option>
                    <option value="Buenavista II">Buenavista II</option>
                    <option value="Buenavista III">Buenavista III</option>
                    <option value="Corregidor">Corregidor</option>
                    <option value="Dulongbayan">Dulongbayan</option>
                    <option value="Governor Ferrer">Governor Ferrer</option>
                    <option value="Javalera">Javalera</option>
                    <option value="Manggahan">Manggahan</option>
                    <option value="Navarro">Navarro</option>
                    <option value="Panungyanan">Panungyanan</option>
                    <option value="Pasong Camachile I">Pasong Camachile I</option>
                    <option value="Pasong Camachile II">Pasong Camachile II</option>
                    <option value="Pasong Kawayan I">Pasong Kawayan I</option>
                    <option value="Pasong Kawayan II">Pasong Kawayan II</option>
                    <option value="Pinagtipunan">Pinagtipunan</option>
                    <option value="Prinza">Prinza</option>
                    <option value="Sampalucan">Sampalucan</option>
                    <option value="Santiago">Santiago</option>
                    <option value="San Francisco">San Francisco</option>
                    <option value="San Gabriel">San Gabriel</option>
                    <option value="San Juan I">San Juan I</option>
                    <option value="San Juan II">San Juan II</option>
                    <option value="Santa Clara">Santa Clara</option>
                    <option value="Tapia">Tapia</option>
                    <option value="Tejero">Tejero</option>
                    <option value="Vibora">Vibora</option>
                    <option value="1896th">1896th</option>
                </select>
            </div>

            <div>
                <label for="sector" class="block text-gray-700 text-sm font-medium mb-2">Sector</label>
                <select id="sector" name="sector" class="form-input" required>
                    <option value="">-- Select Sector --</option>
                    <option value="Student">Student</option>
                    <option value="Government Employee">Government Employee</option>
                    <option value="PWD">PWD</option>
                    <option value="Senior Citizen">Senior Citizen</option>
                    <option value="Unemployed">Unemployed</option>
                    <option value="Solo Parent">Solo Parent</option>
                    <option value="Out of School Youth">Out of School Youth</option>
                </select>
            </div>

            <div>
                <label for="reasonForVisit" class="block text-gray-700 text-sm font-medium mb-2">Reason for Visit</label>
                <select id="reasonForVisit" name="reasonForVisit" class="form-input" required>
                    <option value="">-- Select Reason --</option>
                    <option value="Free Computer Access">Free Computer Access</option>
                    <option value="Free Printing Services">Free Printing Services</option>
                    <option value="Visitor">Visitor</option>
                </select>
            </div>

            <button type="button" id="showPrivacyButton" class="form-button">Submit</button>
        </form>
    </div>

    <!-- Custom Modal for Data Privacy Statement -->
    <div id="privacyModal" class="modal-overlay">
        <div class="modal-content text-justify">
            <h3 class="text-xl font-bold mb-4 text-gray-800 text-center">PESO TRAINING CENTER DATA PRIVACY ACT OF 2012 STATEMENT (R.A. 10173)</h3>
            <p class="text-gray-700 text-sm leading-relaxed mb-3">
                The City of General Trias PESO Training Center guarantees the protection of your privacy and ensures the safety and security of personal data under its control and custody. The personal data obtained from this online registration form is entered and stored within the Training Center’s learning management system and will only be accessed by the City of General Trias PESO Training Center’s authorized personnel.
                City of General Trias PESO Training Center has instituted appropriate organizational, technical, and physical security measures to ensure the protection of your data.
            </p>
            <p class="text-gray-700 text-sm leading-relaxed">
                The information collected herein shall only be used for the documentation of the data subject to the City of General Trias PESO Training Center Program of the City of General Trias. By submitting this online form, you are giving your consent for the City of General Trias PESO Training Center to collect, record, or organize your data to process your enrollment in the program above.
            </p>
            <div class="flex justify-center mt-6">
                <button id="agreePrivacyButton" class="modal-agree-button">I Agree</button>
            </div>
        </div>
    </div>

    <!-- Custom Modal for Submission Messages (Success/Error/Loading) -->
    <div id="messageModal" class="modal-overlay">
        <div class="modal-content">
            <p id="modalMessage" class="text-lg font-semibold mb-4"></p>
            <button id="modalCloseButton" class="modal-close-button">Close</button>
        </div>
    </div>

    <script>
        const form = document.getElementById('registrationForm');
        const showPrivacyButton = document.getElementById('showPrivacyButton');
        const privacyModal = document.getElementById('privacyModal');
        const agreePrivacyButton = document.getElementById('agreePrivacyButton');

        const messageModal = document.getElementById('messageModal');
        const modalMessage = document.getElementById('modalMessage');
        const modalCloseButton = document.getElementById('modalCloseButton');
        const modalContent = messageModal.querySelector('.modal-content');

        // IMPORTANT: Replace this with your deployed Google Apps Script Web App URL
        // Instructions on how to get this URL are provided in the explanation below.
        const GOOGLE_APPS_SCRIPT_WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbxZ5VYcGcuqwkZHCGEBrT3v0sN-Khx6lJBl8DNU4nfX/dev';

        // Event listener for the initial "Register Now" button click
        showPrivacyButton.addEventListener('click', () => {
            // First, validate the form fields
            if (!form.checkValidity()) {
                // If form is not valid, trigger native browser validation messages
                form.reportValidity();
                return; // Stop here if validation fails
            }
            privacyModal.classList.add('show'); // Show the privacy statement modal
        });

        // Event listener for the "Agree" button in the privacy modal
        agreePrivacyButton.addEventListener('click', async () => {
            privacyModal.classList.remove('show'); // Hide the privacy statement modal
            await submitForm(); // Proceed with form submission
        });

        // Event listener for the "Close" button in the message modal
        modalCloseButton.addEventListener('click', () => {
            hideMessage();
        });

        // Function to handle the actual form submission
        async function submitForm() {
            showMessage('Submitting your registration...', 'info'); // Show loading message

            const formData = new FormData(form);
            const data = {};
            for (let [key, value] of formData.entries()) {
                data[key] = value;
            }

            try {
                const response = await fetch(GOOGLE_APPS_SCRIPT_WEB_APP_URL, {
                    method: 'POST',
                    mode: 'no-cors', // Required for Google Apps Script as it doesn't send CORS headers by default
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: new URLSearchParams(data).toString(), // Send data as URL-encoded form data
                });

                // Since mode: 'no-cors' is used, we cannot directly read the response.
                // We assume success if the fetch operation completes without network errors.
                // The Google Apps Script will handle the actual data writing.
                showMessage('Registration successful! Thank you.', 'success');
                form.reset(); // Clear the form after successful submission
            } catch (error) {
                console.error('Error submitting form:', error);
                showMessage('An error occurred during registration. Please try again.', 'error');
            }
        }

        // Function to show the message modal
        function showMessage(message, type) {
            modalMessage.textContent = message;
            modalContent.classList.remove('success', 'error', 'info'); // Remove previous types
            modalCloseButton.style.display = 'none'; // Hide close button for info/loading state

            if (type === 'success') {
                modalContent.classList.add('success');
                modalCloseButton.style.display = 'block'; // Show close button on success/error
            } else if (type === 'error') {
                modalContent.classList.add('error');
                modalCloseButton.style.display = 'block'; // Show close button on success/error
            } else if (type === 'info') {
                modalContent.classList.add('info');
            }
            messageModal.classList.add('show'); // Show the message modal overlay
        }

        // Function to hide the message modal
        function hideMessage() {
            messageModal.classList.remove('show'); // Hide the message modal overlay
            // Optionally reset content and type after hiding
            modalMessage.textContent = '';
            modalContent.classList.remove('success', 'error', 'info');
        }
    </script>
</body>
</html>
